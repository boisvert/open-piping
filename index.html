<!doctype html>
<meta charset="utf-8" />

<head>
    <script src="open workflow.js"></script>
    <title>Compile an S-expression</title>
</head>

<body>

<h1>Compile an S-expression into a function call and function set</h1>

This page is a starting point for a system of "pipes" - of graphical functional programming for web service / SOA applications.
All code is open source (license and github project, er, coming soon). The json s-expression can be defined from 
graphical blocks, and compiled into not just one, but multiple languages common on web server and clients - e.g. javascript, jquery,
php, node.js etc. The resulting systems could then be executed, but also deployed in new systems.
<p>
Functions pre-defined both provide access to the capability of the language(s); limit that access - so that an end-user can program
a service running remotely in a secure environment, sand-boxed by defined functions; and will define the graphical blocks available
to the end-user. Limits to processing capabilities must not be inherent to the language, but instead to the environment in which it runs,
which can be set with, for example, a processing time limit.
<p>
The intention is to have a graphical tool that can prolong the availability of Open data and services with an Open system for user-defined processes,
that would have to be at once open, easy to use and deploy, and interoperate, allowing users to take control of the processes they want to
operate on data.

<p>
The test tool below compiles an expression in javascript and you can run the compiled code, alerting the result.
It is limited in many ways - needs variable setting, error handling, more example result languages, poor interface -
But it is a proof of concept. Functions defined are a small set of mathematical and logic primitives:
plus, minus, times, lt (for less than), pythagoras, sqrt, plus if for conditional and defun for new functions.
<p>
Code
<input type="button" value="Example1" onClick="inject(0);" /> 
<input type="button" value="Example2" onClick="inject(1);" /> 
<input type="button" value="Example3" onClick="inject(2);" />
<input type="button" value="Example4" onClick="inject(3);" /> 
<input type="button" value="Example5" onClick="inject(4);" /> 
<br />
<textarea id="s-exp" cols="80" rows="10">
["plus", 1, 2]
</textarea>
<br />
<input type="button" value="compile" onClick="go()" /> <br />
Result<br />
<textarea id="result" cols="80" rows="10">
</textarea>
<input type="button" value="Show result" onClick="runres();" /> <br />


<script>

// show sample of code
function inject(num) {
   var samples = [
      '[\n  ["defun", "square", ["x"], ["times", "x", "x"]],\n  ["square", 2]\n]',
      '[\n  ["defun", "fac", ["n"], ["if", ["lt", "n", 2], 1, ["times", "n", ["fac", ["minus", "n", 1]] ]]],\n  ["fac", 10]\n]',
      '["pythagoras", 3, 4]',
      '[1, 2, 3]',
      '1'
   ];
   document.getElementById('s-exp').value=samples[num];
}

// compile event
function go() {
   var Exp = JSON.parse(document.getElementById('s-exp').value);
   document.getElementById('result').value=compile(Exp);
}

// run result
function runres() {
   var c = document.getElementById('result').value;
   alert(eval(c));
}

</script>
</body>
</html>
